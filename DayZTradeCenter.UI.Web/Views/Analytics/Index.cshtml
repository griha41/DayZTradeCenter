@model DayZTradeCenter.UI.Web.Models.AnalyticsViewModel

@{
    ViewBag.Title = "Index";
}

<h2>Analytics</h2>

<hr />

<div class="container" style="margin-top: 20px">
    <div class="row">
        <div class="container">
            <div class="row">
                <div class="col-md-4 col-md-offset-1">
                    <h4>Most wanted items</h4>
                    <table class="table table-bordered">
                        <tr>
                            <th style="width: 40px">Id</th>
                            <th>Name</th>
                            <th>#</th>
                        </tr>
                        <tbody>
                            @foreach (var item in Model.MostWantedItems)
                            {
                                <tr>
                                    <td>@item.Item.Id</td>
                                    <td>@item.Item.Name</td>
                                    <td>@item.Count</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
                <div class="col-md-4 col-md-offset-1">
                    <h4>Most offered items</h4>
                    <table class="table table-bordered">
                        <tr>
                            <th style="width: 40px">Id</th>
                            <th>Name</th>
                            <th>#</th>
                        </tr>
                        <tbody>
                            @foreach (var item in Model.MostOfferedItems)
                            {
                                <tr>
                                    <td>@item.Item.Id</td>
                                    <td>@item.Item.Name</td>
                                    <td>@item.Count</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="row" style="margin-top: 20px">
        <div class="jumbotron">
            <div class="row" style="margin-top: -20px">
                <div class="col-md-2">
                    Trends by item
                </div>
                <div class="col-md-2">
                    @Html.LabelFor(model => model.ItemId)
                    @Html.DropDownListFor(
                        model => model.ItemId,
                        Model.Items,
                        "Choose... ")
                    @Html.ValidationMessageFor(model => model.ItemId, "", new { @class = "text-danger" })
                </div>
            </div>
            <div id="chart">
                @Html.Partial("_TrendsChart", Model.Chart);
            </div>
        </div>
    </div>
</div>

@section scripts {
    @Scripts.Render("~/bundles/highcharts")

    <script>
        $(function () {
            $("#ItemId").change(function () {
                var itemId = $("#ItemId").val();
                $("#chart").load(
                    '@(Url.Action("GetDailyTrendsFor", "Analytics", null, Request.Url.Scheme))?itemId=' + itemId);
            });
        });
    </script>
}